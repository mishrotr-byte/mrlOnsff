<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>mrlOnsf – ИИ нового поколения</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg: #0a0a14;
      --card: #11111a;
      --orange: #ff6a00;
      --glow: #ff8c33;
      --text: #f0f0f0;
      --text-dim: #888;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body,html { height:100vh; overflow:hidden; background:var(--bg); color:var(--text); font-family:-apple-system,system-ui,sans-serif; }
    
    /* КУБИКИ — ЛУЧШИЕ В МИРЕ */
    #particles { position:fixed; inset:0; pointer-events:none; z-index:1; }
    .cube { 
      position:absolute; width:12px; height:12px; background:var(--orange); 
      box-shadow:0 0 25px var(--glow), 0 0 50px var(--orange); border-radius:3px;
      animation:cube-float 4s infinite ease-in-out;
    }
    @keyframes cube-float {
      0%,100% { opacity:0.6; transform:translateY(0) rotate(0deg) scale(1); }
      50% { opacity:1; transform:translateY(-40px) rotate(180deg) scale(1.3); }
    }

    /* ЭКРАН АВТОРИЗАЦИИ */
    #auth {
      position:fixed; inset:0; background:var(--bg); z-index:9999;
      display:flex; flex-direction:column; justify-content:center; align-items:center; gap:30px;
      transition:opacity .4s;
    }
    .logo {
      font-size:68px; font-weight:900; letter-spacing:-2px;
      background:linear-gradient(45deg, #ff6a00, #ff9a44);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow:0 0 40px rgba(255,106,0,.6);
    }
    .auth-btn {
      width:300px; padding:18px; border-radius:50px; border:none; font-size:18px; font-weight:700;
      cursor:pointer; transition:all .3s; box-shadow:0 8px 30px rgba(0,0,0,.5);
      backdrop-filter:blur(10px);
    }
    .auth-btn:active { transform:scale(0.95); }
    .apple { background:#000; color:#fff; }
    .google { background:#fff; color:#000; }
    .phone { background:var(--orange); color:#000; box-shadow:0 0 40px rgba(255,106,0,.6); }

    /* ОСНОВНОЙ ИНТЕРФЕЙС */
    #main { display:none; height:100vh; display:grid; grid-template-columns:320px 1fr; }
    .sidebar {
      background:var(--card); border-right:1px solid #333; padding:20px 0; overflow-y:auto;
      transition:transform .35s cubic-bezier(0.4,0,0.2,1);
    }
    .new-chat {
      margin:0 20px 20px; padding:16px; background:var(--orange); color:#000;
      border:none; border-radius:18px; font-weight:800; font-size:16px;
      box-shadow:0 0 30px var(--glow); cursor:pointer; transition:.3s;
    }
    .new-chat:active { transform:scale(0.96); }
    .chat-item {
      padding:16px 24px; cursor:pointer; font-size:15px; transition:.25s;
      border-left:4px solid transparent;
    }
    .chat-item:hover { background:rgba(255,106,0,.15); }
    .chat-item.active { background:rgba(255,106,0,.25); border-left-color:var(--orange); font-weight:600; }

    .chat-area { display:flex; flex-direction:column; background:var(--bg); }
    .header {
      padding:20px; text-align:center; font-size:24px; font-weight:900;
      color:var(--orange); text-shadow:0 0 20px var(--glow);
      border-bottom:1px solid #333;
    }
    .messages {
      flex:1; overflow-y:auto; padding:20px; display:flex; flex-direction:column; gap:16px;
    }
    .msg {
      max-width:80%; padding:16px 20px; border-radius:24px; line-height:1.6;
      animation:msg-in .4s ease-out;
    }
    @keyframes msg-in { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:none; } }
    .user { align-self:flex-end; background:var(--orange); color:#000; border-bottom-right-radius:4px; }
    .bot { align-self:flex-start; background:var(--card); border-bottom-left-radius:4px; }

    .input-area {
      padding:16px; background:rgba(10,10,20,.98); border-top:1px solid #333;
    }
    .input-wrapper {
      position:relative; display:flex; align-items:center;
    }
    #prompt {
      flex:1; padding:18px 70px 18px 60px; background:#1e1e2e; border:1px solid #444;
      border-radius:30px; color:#fff; font-size:17px; outline:none;
    }
    .plus-btn, .send-btn {
      position:absolute; background:none; border:none; font-size:32px; cursor:pointer;
    }
    .plus-btn { left:16px; color:var(--orange); }
    .send-btn { right:10px; background:var(--orange); width:52px; height:52px; border-radius:50%;
      color:#000; font-size:26px; box-shadow:0 0 30px var(--glow); }

    /* МЕНЮ ФУНКЦИЙ */
    #menu {
      position:fixed; bottom:90px; left:16px; right:16px; background:rgba(20,20,35,.98);
      border:2px solid var(--orange); border-radius:20px; padding:12px 0;
      box-shadow:0 20px 50px rgba(0,0,0,.8), 0 0 50px rgba(255,106,0,.5);
      display:none; z-index:1000; animation:menu-in .3s;
    }
    @keyframes menu-in { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:none; } }
    .menu-item {
      padding:18px 24px; color:#fff; font-size:17px; display:flex; align-items:center; cursor:pointer;
      transition:.2s;
    }
    .menu-item:hover { background:rgba(255,106,0,.2); }
    .menu-item span { margin-left:16px; }
  </style>
</head>
<body>

  <div id="particles"></div>

  <!-- АВТОРИЗАЦИЯ -->
  <div id="auth">
    <div class="logo">mrlOnsf</div>
    <button class="auth-btn apple">Войти через Apple</button>
    <button class="auth-btn google">Войти через Google</button>
    <button class="auth-btn phone">Войти по номеру</button>
  </div>

  <!-- ОСНОВНОЙ ИНТЕРФЕЙС -->
  <div id="main">
    <div class="sidebar" id="sidebar">
      <button class="new-chat">＋ Новая беседа</button>
      <div id="chat-list"></div>
    </div>
    <div class="chat-area">
      <div class="header">mrlOnsf</div>
      <div class="messages" id="messages">
        <div class="msg bot">Привет! Я <b>mrlOnsf</b> — твой ИИ нового поколения.<br><br>
        Я умею:<br>
        • Генерировать видео (Kling AI)<br>
        • Создавать картинки (Flux + SD3)<br>
        • Делать презентации<br>
        • Писать рецепты с калориями<br>
        • Генерировать музыку<br><br>
        Нажми на <b>＋</b> и выбери функцию!</div>
      </div>
      <div class="input-area">
        <div class="input-wrapper">
          <button class="plus-btn">＋</button>
          <input type="text" id="prompt" placeholder="Напиши что угодно...">
          <button class="send-btn">Send</button>
        </div>
      </div>
    </div>
  </div>

  <!-- МЕНЮ + -->
  <div id="menu">
    <div class="menu-item" data-mode="video">Видео (Kling AI)</div>
    <div class="menu-item" data-mode="image">Картинка (Flux + SD3)</div>
    <div class="menu-item" data-mode="ppt">Презентация (Gamma)</div>
    <div class="menu-item" data-mode="recipe">Рецепт + калории</div>
    <div class="menu-item" data-mode="music">Музыка (Suno v4)</div>
    <div class="menu-item" data-mode="voice">Голос → текст</div>
    <div class="menu-item" data-mode="camera">Камера → арт</div>
  </div>

  <script>
    const tg = window.Telegram.WebApp; tg.ready(); tg.expand();
    const auth = document.getElementById('auth');
    const main = document.getElementById('main');
    const messages = document.getElementById('messages');
    const prompt = document.getElementById('prompt');
    const sidebar = document.getElementById('sidebar');
    let mode = null;
    let chats = JSON.parse(localStorage.getItem('mrlOnsf_pro') || '[]');
    let currentChat = null;

    // КУБИКИ — МАКСИМАЛЬНО КРАСИВЫЕ
    document.addEventListener('pointermove', e => {
      if (Math.random() > 0.3) return;
      const cube = document.createElement('div');
      cube.className = 'cube';
      cube.style.left = (e.clientX - 6) + 'px';
      cube.style.top = (e.clientY - 6) + 'px';
      cube.style.animationDelay = Math.random() * 2 + 's';
      document.getElementById('particles').appendChild(cube);
      setTimeout(() => cube.remove(), 4000);
    });

    // АВТОРИЗАЦИЯ
    document.querySelectorAll('.auth-btn').forEach(btn => {
      btn.onclick = () => {
        auth.style.opacity = '0';
        setTimeout(() => {
          auth.style.display = 'none';
          main.style.display = 'grid';
          if (!chats.length) createChat();
          else openChat(chats[chats.length-1].id);
        }, 400);
      };
    });

    // ЧАТЫ
    function createChat() {
      const id = Date.now();
      const chat = { id, title: 'Новая беседа', messages: [] };
      chats.push(chat);
      save();
      openChat(id);
    }
    function openChat(id) {
      currentChat = chats.find(c => c.id === id);
      messages.innerHTML = '<div class="msg bot">Привет! Я <b>mrlOnsf</b> — твой ИИ нового поколения.<br><br>Нажми на ＋ и выбери, что создать!</div>';
      currentChat.messages.forEach(m => addMessage(m.text, m.role));
      renderChatList();
      messages.scrollTop = messages.scrollHeight;
    }
    function renderChatList() {
      document.getElementById('chat-list').innerHTML = chats.map(c => 
        `<div class="chat-item ${c.id===currentChat?.id?'active':''}" onclick="openChat(${c.id})">
          ${c.title || 'Новая беседа'}
        </div>`
      ).join('');
    }
    function save() { localStorage.setItem('mrlOnsf_pro', JSON.stringify(chats)); }
    document.querySelector('.new-chat').onclick = createChat;

    function addMessage(text, role) {
      const div = document.createElement('div');
      div.className = `msg ${role}`;
      div.innerHTML = text;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    // СВАЙП САЙДБАРА
    let startX = 0;
    document.addEventListener('touchstart', e => startX = e.touches[0].clientX);
    document.addEventListener('touchmove', e => {
      if (startX < 60 && e.touches[0].clientX - startX > 100) {
        sidebar.style.transform = 'translateX(-100%)';
      }
    });
    sidebar.addEventListener('click', () => sidebar.style.transform = 'translateX(0)');

    // ОТПРАВКА
    async function send() {
      const text = prompt.value.trim();
      if (!text) return;
      addMessage(text, 'user');
      prompt.value = '';
      addMessage('<i style="color:#888">mrlOnsf создаёт магию...</i>', 'bot');

      setTimeout(() => {
        messages.lastChild.remove();
        let reply = `Ты написал: "${text}"<br><br>Скоро я буду генерировать всё, что ты захочешь — видео, музыку, презентации...`;
        if (mode === 'video') reply = `<video src="https://videos.pexels.com/video-files/854195/854195-720-25fps.mp4" controls style="width:100%;border-radius:16px"></video><br>Видео сгенерировано за 11 сек!`;
        if (mode === 'image') reply = `<img src="https://picsum.photos/800/1200?random=${Date.now()}" style="width:100%;border-radius:16px"><br>Шедевр от Flux + SD3`;
        if (mode === 'recipe' && text.includes('карбонара')) reply = `Паста Карбонара (2 порции)<br>• Спагетти 200г<br>• Гуанчиале 150г<br>• Яйца 2+2 желтка<br>• Пекорино 80г<br>• Перец<br><br>820 ккал/порция<br>Готовится 12 минут`;

        addMessage(reply, 'bot');
        currentChat.messages.push({role:'user', text}, {role:'bot', text: reply});
        if (currentChat.messages.length === 2) currentChat.title = text.slice(0,30);
        save(); renderChatList();
      }, 1800);
    }
    document.querySelector('.send-btn').onclick = send;
    prompt.addEventListener('keydown', e => e.key === 'Enter' && send());

    // МЕНЮ
    document.querySelector('.plus-btn').onclick = () => {
      document.getElementById('menu').style.display = 
        document.getElementById('menu').style.display === 'block' ? 'none' : 'block';
    };
    document.querySelectorAll('.menu-item').forEach(item => {
      item.onclick = () => {
        mode = item.dataset.mode;
        document.getElementById('menu').style.display = 'none';
        prompt.placeholder = item.querySelector('span')?.innerText || item.innerText + '...';
        prompt.focus();
      };
    });

    // АВТОЗАГРУЗКА
    if (chats.length) {
      auth.style.display = 'none';
      main.style.display = 'grid';
      openChat(chats[chats.length-1].id);
    }
  </script>
</body>
</html>
