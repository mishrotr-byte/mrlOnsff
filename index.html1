<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>mrlOnsf</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{--bg:#0a0a14;--dark:#11111a;--orange:#ff6a00;--glow:#ff8c33;--text:#f0f0f0}
    body{margin:0;height:100vh;overflow:hidden;background:var(--bg);color:var(--text);font-family:system-ui}
    #p{position:fixed;inset:0;pointer-events:none;z-index:1}
    .c{position:absolute;width:11px;height:11px;background:var(--orange);box-shadow:0 0 22px var(--glow);border-radius:3px;animation:f 3s infinite}
    @keyframes f{0%,100%{opacity:.8;transform:translateY(0) rotate(0)}50%{opacity:1;transform:translateY(-30px) rotate(180deg)}}
    #auth{position:fixed;inset:0;background:var(--bg);z-index:999;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:25px}
    .logo{font-size:56px;font-weight:900;background:linear-gradient(45deg,#ff6a00,#ff8c33);-webkit-background-clip:text;color:transparent}
    .ab{width:280px;padding:16px;border-radius:16px;border:none;font-weight:600;margin:6px;box-shadow:0 4px 25px rgba(255,106,0,.4);cursor:pointer}
    .a{background:#000;color:#fff}.g{background:#fff;color:#000}.p{background:var(--orange);color:#000}.e{background:var(--dark);color:var(--orange);border:2px solid var(--orange)}
    #main{display:none;height:100vh}
    .l{display:grid;grid-template-columns:290px 1fr;height:100vh}
    .s{background:var(--dark);border-right:1px solid #333;padding:15px 0;overflow-y:auto}
    .n{margin:15px;padding:14px;background:var(--orange);color:#000;border:none;border-radius:12px;font-weight:700;box-shadow:0 0 20px var(--glow)}
    .ci{padding:14px 20px;cursor:pointer;transition:.2s}
    .ci:hover,.ci.active{background:rgba(255,106,0,.25)}
    .ca{display:flex;flex-direction:column;position:relative}
    .h{padding:15px;text-align:center;font-size:21px;font-weight:800;color:var(--orange);text-shadow:0 0 12px var(--glow)}
    .m{flex:1;overflow-y:auto;padding:10px}
    .msg{max-width:88%;margin:10px 0;padding:13px 18px;border-radius:20px;line-height:1.5;word-wrap:break-word}
    .u{align-self:flex-end;background:var(--orange);color:#000;border-bottom-right-radius:4px}
    .b{align-self:flex-start;background:var(--dark);border-bottom-left-radius:4px}
    .ib{padding:10px;background:rgba(17,17,26,.97);border-top:1px solid #333;position:relative}
    #pr{width:100%;padding:15px 65px 15px 55px;background:#222;border:1px solid #444;border-radius:28px;color:#fff;font-size:16px;outline:none}
    .pl{position:absolute;left:15px;top:15px;background:none;border:none;font-size:30px;color:var(--orange)}
    .se{position:absolute;right:12px;top:11px;background:var(--orange);width:46px;height:46px;border-radius:50%;border:none;font-size:24px;box-shadow:0 0 20px var(--glow)}
    .menu{position:fixed;bottom:80px;left:10px;right:10px;background:rgba(20,20,35,.98);border:1px solid var(--orange);border-radius:18px;padding:12px 0;box-shadow:0 0 40px rgba(255,106,0,.6);display:none;z-index:100}
    .mi{padding:16px 22px;color:#fff;font-size:16px;display:flex;align-items:center}
    .mi span{margin-left:16px}
    .load{color:#888;font-style:italic}
  </style>
</head>
<body>
<div id="p"></div>

<div id="auth">
  <div class="logo">mrlOnsf</div>
  <button class="ab a">Apple –í–æ–π—Ç–∏</button>
  <button class="ab g">Google –í–æ–π—Ç–∏</button>
  <button class="ab p">–ù–æ–º–µ—Ä –í–æ–π—Ç–∏</button>
  <button class="ab e">–ü–æ—á—Ç–∞ –í–æ–π—Ç–∏</button>
</div>

<div id="main">
  <div class="l">
    <div class="s">
      <button class="n">Ôºã –ù–æ–≤–∞—è –±–µ—Å–µ–¥–∞</button>
      <div id="cl"></div>
    </div>
    <div class="ca">
      <div class="h">mrlOnsf</div>
      <div class="m" id="ms"></div>
      <div class="ib">
        <div style="position:relative">
          <button class="pl" id="pl">Ôºã</button>
          <input type="text" id="pr" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ mrlOnsf...">
          <button class="se" id="se">‚û§</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="menu" id="menu">
  <div class="mi" data-m="video">üé¨ –í–∏–¥–µ–æ (Kling AI)</div>
  <div class="mi" data-m="image">üñº –ö–∞—Ä—Ç–∏–Ω–∫–∞ (Flux + SD3)</div>
  <div class="mi" data-m="ppt">üìä –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è (Gamma)</div>
  <div class="mi" data-m="recipe">üç≥ –†–µ—Ü–µ–ø—Ç + –∫–∞–ª–æ—Ä–∏–∏</div>
  <div class="mi" data-m="camera">üì∏ –ö–∞–º–µ—Ä–∞ ‚Üí –∞—Ä—Ç</div>
  <div class="mi" data-m="music">üéµ –ú—É–∑—ã–∫–∞ (Suno)</div>
</div>

<script>
const tg = window.Telegram.WebApp; tg.ready(); tg.expand();
const auth = document.getElementById('auth'), main = document.getElementById('main');
const ms = document.getElementById('ms'), pr = document.getElementById('pr');
let mode = null, chats = JSON.parse(localStorage.getItem('mrlOnsf')||'[]'), cid = null;

// –ö—É–±–∏–∫–∏
document.addEventListener('pointermove',e=>{const c=document.createElement('div');c.className='c';
c.style.left=(e.clientX-5.5)+'px';c.style.top=(e.clientY-5.5)+'px';document.getElementById('p').appendChild(c);
setTimeout(()=>c.remove(),3000)});

// –í—Ö–æ–¥
document.querySelectorAll('#auth button, #auth span').forEach(b=>b.onclick=()=>{auth.style.display='none';main.style.display='flex';
if(chats.length===0) newChat(); else openChat(chats[chats.length-1].id); renderCL()});

// –ß–∞—Ç—ã
function newChat(){const id=Date.now();chats.push({id,title:'–ù–æ–≤–∞—è –±–µ—Å–µ–¥–∞',msgs:[]});save();openChat(id);renderCL()}
function openChat(id){cid=id;const c=chats.find(x=>x.id===id);ms.innerHTML='';c.msgs.forEach(m=>add(m.text,m.role));renderCL();ms.scrollTop=ms.scrollHeight}
function renderCL(){document.getElementById('cl').innerHTML='';chats.forEach(c=>{const d=document.createElement('div');d.className='ci'+(c.id===cid?' active':'');
d.innerHTML=`<span>${c.title||'–ù–æ–≤–∞—è –±–µ—Å–µ–¥–∞'}</span>`;d.onclick=()=>openChat(c.id);document.getElementById('cl').appendChild(d)})}
function save(){localStorage.setItem('mrlOnsf',JSON.stringify(chats))}
document.querySelector('.n').onclick=newChat;

// –°–æ–æ–±—â–µ–Ω–∏—è
function add(t,r){const d=document.createElement('div');d.className=`msg ${r}`;d.innerHTML=t;ms.appendChild(d);ms.scrollTop=ms.scrollHeight}
function send(){
  let text=pr.value.trim(); if(!text) return;
  add(text,'u'); pr.value=''; const load=add('<i class="load">mrlOnsf –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç...</i>','b');
  setTimeout(()=>{
    load.remove();
    let reply = `–≠—Ç–æ –ø–æ–∫–∞ –¥–µ–º–æ, –Ω–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!`;
    
    if(mode==='video') reply=`<video src="https://v3.cdnpk.net/videvo_files/video/free/2023-08/large_watermarked/230811_01_B_Roll_4k_015_preview.mp4" controls style="width:100%;border-radius:16px"></video><br>–í–∏–¥–µ–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∑–∞ 12 —Å–µ–∫!`;
    if(mode==='image') reply=`<img src="https://picsum.photos/800/1200?random=${Date.now()}" style="width:100%;border-radius:16px"><br>Flux + SD3 –≤ –¥–µ–ª–µ!`;
    if(mode==='ppt') reply=`–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞!<br><a href="https://gamma.app/public/example" style="color:var(--orange)">–û—Ç–∫—Ä—ã—Ç—å –≤ Gamma ‚Üí</a>`;
    if(mode==='recipe' && text.toLowerCase().includes('–∫–∞—Ä–±–æ–Ω–∞—Ä–∞')) reply=`–ü–∞—Å—Ç–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞<br>‚óè –°–ø–∞–≥–µ—Ç—Ç–∏ 200–≥<br>‚óè –ì—É–∞–Ω—á–∏–∞–ª–µ 150–≥<br>‚óè –Ø–π—Ü–∞ 2+2 –∂–µ–ª—Ç–∫–∞<br>‚óè –ü–µ–∫–æ—Ä–∏–Ω–æ 80–≥<br>‚óè –ü–µ—Ä–µ—Ü<br><br>820 –∫–∫–∞–ª/–ø–æ—Ä—Ü–∏—è<br>–ì–æ—Ç–æ–≤–∏—Ç—Å—è 12 –º–∏–Ω—É—Ç`;

    add(reply,'b');
    const chat=chats.find(x=>x.id===cid); chat.msgs.push({role:'u',text},{role:'b',text:reply});
    if(!chat.title) chat.title=text.slice(0,28); save(); renderCL();
  },1800);
}
document.getElementById('se').onclick=send;
pr.addEventListener('keypress',e=>e.key==='Enter'&&send());

// –ú–µ–Ω—é +
document.getElementById('pl').onclick=()=>{document.getElementById('menu').style.display=document.getElementById('menu').style.display==='block'?'none':'block'}
document.querySelectorAll('.mi').forEach(i=>{i.onclick=()=>{mode=i.dataset.m;document.getElementById('menu').style.display='none';
pr.placeholder=i.textContent+'...';pr.focus()}});

// –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞
if(chats.length>0){auth.style.display='none';main.style.display='flex';openChat(chats[chats.length-1].id);renderCL()}
</script>
</body>
</html>
